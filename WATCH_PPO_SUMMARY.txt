â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            âœ… WATCH_BC_GAME.PY NOW SUPPORTS PPO CHECKPOINTS!             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ¯ What Changed

**File:** `src/evaluation/watch_bc_game.py`

**Changes:**
1. âœ… Auto-detects checkpoint type (BC or PPO)
2. âœ… Loads PPO checkpoints correctly (extracts backbone from policy_state_dict)
3. âœ… Loads BC checkpoints correctly (uses model_state_dict)
4. âœ… Default changed to PPO: `checkpoints/ppo_from_bc/latest_model.pt`
5. âœ… Shows appropriate info based on checkpoint type

---

## ğŸš€ Quick Usage

### Watch PPO Agent (Easiest)

```bash
./watch_ppo.sh
```

### Watch PPO Agent (Direct)

```bash
python src/evaluation/watch_bc_game.py \
    --checkpoint checkpoints/ppo_from_bc/latest_model.pt \
    --num_games 3
```

### Watch BC Agent (Baseline)

```bash
python src/evaluation/watch_bc_game.py \
    --checkpoint checkpoints/bc/best_model.pt \
    --num_games 3
```

---

## ğŸ“Š Output Examples

### For PPO Checkpoint

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ® WATCHING PPO AGENT PLAY GENERALS.IO                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Checkpoint: checkpoints/ppo_from_bc/latest_model.pt
Type: PPO                    â† Auto-detected!
Games to play: 3
Opponent: BC
Epsilon (exploration): 0.0
Render delay: 0.1s per step

âœ… Loaded PPO checkpoint
   Episode: 50               â† PPO-specific info
   Total steps: 218,665
   Best win rate: 0.0%
```

### For BC Checkpoint

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ® WATCHING BC AGENT PLAY GENERALS.IO                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Checkpoint: checkpoints/bc/best_model.pt
Type: BC                     â† Auto-detected!
Games to play: 3
Opponent: BC
Epsilon (exploration): 0.0
Render delay: 0.1s per step

âœ… Loaded BC checkpoint
   Test accuracy: 27.75%     â† BC-specific info
```

---

## ğŸ”§ Technical Details

### Checkpoint Detection

```python
# Detect type
checkpoint = torch.load(checkpoint_path)
is_ppo = 'policy_state_dict' in checkpoint
```

### PPO Loading

```python
# PPO has nested structure: policy_state_dict['backbone.*']
full_state_dict = checkpoint['policy_state_dict']

# Extract backbone weights (remove 'backbone.' prefix)
backbone_state_dict = {}
for key, value in full_state_dict.items():
    if key.startswith('backbone.'):
        new_key = key.replace('backbone.', '')
        backbone_state_dict[new_key] = value

# Load into network
network.load_state_dict(backbone_state_dict)
```

### BC Loading

```python
# BC has flat structure: model_state_dict
network.load_state_dict(checkpoint['model_state_dict'])
```

---

## ğŸ“ Files Created/Modified

1. **`src/evaluation/watch_bc_game.py`** â† Modified
   - Auto-detects checkpoint type
   - Loads both BC and PPO correctly
   - Default changed to PPO

2. **`watch_ppo.sh`** â† New helper script
   - Shows checkpoint info
   - Runs 3 visual games
   - Easy to use

3. **`WATCH_AGENT_GUIDE.md`** â† Complete usage guide
   - All command-line options
   - Examples for every use case
   - Troubleshooting tips

---

## ğŸ® Common Commands

| Command | Purpose |
|---------|---------|
| `./watch_ppo.sh` | Watch PPO agent (3 games, easiest) |
| `python src/evaluation/watch_bc_game.py` | Watch PPO agent (default) |
| `--checkpoint checkpoints/bc/best_model.pt` | Watch BC agent instead |
| `--num_games 5` | Play 5 games instead of 3 |
| `--opponent random` | Play vs random opponent |
| `--delay 0.5` | Slower playback (0.5s per step) |
| `--epsilon 0.1` | Add 10% exploration |

---

## ğŸ“Š What to Watch For

### PPO vs BC Comparison

**Expected PPO Improvements:**
- âœ… More exploration (visits more tiles)
- âœ… Better strategy (actively seeks enemy general)
- âœ… Higher win rate (beats BC opponent)
- âœ… Captures cities more aggressively
- âœ… More decisive victories (fewer steps to win)

**BC Baseline Behavior:**
- âŒ Limited exploration (~15 tiles)
- âŒ Passive strategy (waits for enemy)
- âŒ 50% win rate vs itself (mirror match)
- âŒ Ignores cities
- âŒ Long, drawn-out games

---

## âœ¨ Summary

| Aspect | Status |
|--------|--------|
| **Auto-detect checkpoint type** | âœ… Yes |
| **Load PPO checkpoints** | âœ… Yes |
| **Load BC checkpoints** | âœ… Yes |
| **Default to PPO** | âœ… Yes |
| **Helper script** | âœ… Created (`watch_ppo.sh`) |
| **Documentation** | âœ… Created (`WATCH_AGENT_GUIDE.md`) |

**You can now watch your PPO agent play!** ğŸ®

```bash
./watch_ppo.sh
```

or

```bash
python src/evaluation/watch_bc_game.py
```

Both work with your PPO checkpoint from `checkpoints/ppo_from_bc/`! ğŸš€
